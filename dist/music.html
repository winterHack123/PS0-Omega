<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="music.css">
    <title>Music</title>
</head>

<!-- npx tailwindcss -i ./src/input.css -o ./dist/music.css --watch  -->

<body class="bg-gray-100 text-gray-800 font-sans">
    <div class="container mx-auto p-4">
        <h1 class="text-3xl font-semibold mb-4">Music Search</h1>
        <div class="flex space-x-2 mb-4">
            <input type="text" id="searchInput" placeholder="Search for music" class="px-4 py-2 w-1/2 border border-gray-300 rounded-md focus:ring focus:ring-blue-300">
            <button id="searchButton" class="px-4 py-2 bg-blue-500 text-white rounded-md hover:bg-blue-600 focus:ring focus:ring-blue-300">Search</button>
        </div>

        <div id="searchResults" class="space-y-4"></div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    <script>
        const searchInput = document.getElementById('searchInput');
        const searchButton = document.getElementById('searchButton');
        const searchResults = document.getElementById('searchResults');

        searchButton.addEventListener('click', performSearch);

        async function performSearch() {
            const query = searchInput.value;
            if (query) {
                searchResults.innerHTML = 'Searching...';

                const options = {
                    method: 'GET',
                    url: 'https://spotify23.p.rapidapi.com/search/',
                    params: {
                        q: query,
                        type: 'multi',
                        offset: '0',
                        limit: '10',
                        numberOfTopResults: '5'
                    },
                    headers: {
                        'X-RapidAPI-Key': 'e0ef2e8ce6msh7168253e6417ca8p1381fajsn28e458f22638',
                        'X-RapidAPI-Host': 'spotify23.p.rapidapi.com'
                    }
                };

                try {
                    const response = await axios.request(options);
                    displaySearchResults(response.data);
                } catch (error) {
                    console.error(error);
                }
            } else {
                searchResults.innerHTML = 'Please enter a search query.';
            }
        }

        function displaySearchResults(data) {
            const tracks = data.tracks.items;

            if (tracks.length === 0) {
                searchResults.innerHTML = 'No results found.';
                return;
            }

            const resultsHTML = tracks.map(track => {
                const trackName = track.name;
                const audioPreviewUrl = track.preview_url;

                return `
                    <div class="bg-white p-4 rounded-md">
                        <h3 class="text-lg font-semibold">${trackName}</h3>
                        <audio controls>
                            <source src="${audioPreviewUrl}" type="audio/mpeg">
                            Your browser does not support the audio element.
                        </audio>
                    </div>
                `;
            });

            searchResults.innerHTML = resultsHTML.join('');
        }
    </script>
</body>

</html>